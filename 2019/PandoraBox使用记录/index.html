<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script><script class="next-config" data-name="main" type="application/json">{"hostname":"blog.lyz05.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":true,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":null,"post_body":null,"coll_header":null,"sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/config.min.js" defer></script><meta name="description" content="前言其实早在大一下就开始使用PandoraBox了，奈何一直没有写篇博文记录一下。PandoraBox是国内从原版OpenWrt整出来的分支。最开始时，我是想直接用OpenWrt，但是好像我用的版本在路由器上有些问题。后面发现了PandoraBox，有着除名字不同外，几乎一模一样的OpenWrt。本次使用的路由器是斐讯K2p。早在高中时就有耳闻当时斐讯搞得0元购，奈何自己太年轻，并没有及时上车。所"><meta property="og:type" content="article"><meta property="og:title" content="PandoraBox使用记录"><meta property="og:url" content="https://blog.lyz05.cn/2019/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/index.html"><meta property="og:site_name" content="Lyz&#39;s Blog"><meta property="og:description" content="前言其实早在大一下就开始使用PandoraBox了，奈何一直没有写篇博文记录一下。PandoraBox是国内从原版OpenWrt整出来的分支。最开始时，我是想直接用OpenWrt，但是好像我用的版本在路由器上有些问题。后面发现了PandoraBox，有着除名字不同外，几乎一模一样的OpenWrt。本次使用的路由器是斐讯K2p。早在高中时就有耳闻当时斐讯搞得0元购，奈何自己太年轻，并没有及时上车。所"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-11-17T17:32:06.000Z"><meta property="article:modified_time" content="2025-08-26T08:15:11.619Z"><meta property="article:author" content="lyz05"><meta property="article:tag" content="教程"><meta property="article:tag" content="网络"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://blog.lyz05.cn/2019/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.lyz05.cn/2019/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/","path":"2019/PandoraBox使用记录/","title":"PandoraBox使用记录"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>PandoraBox使用记录 | Lyz's Blog</title><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous" defer></script><script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous" defer></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/utils.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/sidebar.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/next-boot.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/third-party/search/local-search.min.js" defer></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/third-party/tags/pdf.min.js" defer></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@11.5.0/dist/mermaid.min.js","integrity":"sha256-2obLuIPcceEhkE3G09G33hBdmE55ivVcZUlcKcGNHjU="}}</script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/third-party/tags/mermaid.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/third-party/pace.min.js" defer></script><script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/third-party/math/mathjax.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous" defer></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://blog.lyz05.cn/2019/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"}</script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-next@8.23.0/source/js/third-party/quicklink.min.js" defer></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Lyz's Blog</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">Never Give Up</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">95</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">30</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">12</span></a></li><li class="menu-item menu-item-lab"><a href="/lab/" rel="section"><i class="fa fa-flask fa-fw fa-fw"></i>实验室</a></li><li class="menu-item menu-item-books"><a href="/books/" rel="section"><i class="fa fa-book fa-fw"></i>阅读</a></li><li class="menu-item menu-item-movie"><a href="/movies/" rel="section"><i class="fa fa-film fa-fw"></i>观影</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E6%B1%82-%E9%80%89%E6%8B%A9"><span class="nav-number">1.1.</span> <span class="nav-text">需求&amp;选择</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E9%80%89%E6%8B%A9"><span class="nav-number">1.1.1.</span> <span class="nav-text">系统选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%89%E6%8B%A9"><span class="nav-number">1.1.2.</span> <span class="nav-text">路由器选择</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%B7%E6%9C%BA"><span class="nav-number">2.</span> <span class="nav-text">刷机</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#uboot"><span class="nav-number">2.1.</span> <span class="nav-text">uboot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pandorabox"><span class="nav-number">2.2.</span> <span class="nav-text">Pandorabox</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LEDE"><span class="nav-number">2.3.</span> <span class="nav-text">LEDE</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE"><span class="nav-number">3.</span> <span class="nav-text">配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%B8%8A%E7%BD%91"><span class="nav-number">3.1.</span> <span class="nav-text">配置上网</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E9%85%8D%E7%BD%AE"><span class="nav-number">3.1.1.</span> <span class="nav-text">路由器配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%85%8D%E7%BD%AE"><span class="nav-number">3.1.2.</span> <span class="nav-text">虚拟机配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSH%E7%AE%A1%E7%90%86"><span class="nav-number">3.2.</span> <span class="nav-text">SSH管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%B7%E8%BD%AF%E4%B8%AD%E5%BF%83"><span class="nav-number">3.3.</span> <span class="nav-text">酷软中心</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%81%9A%E6%97%81%E8%B7%AF%E7%94%B1"><span class="nav-number">3.3.1.</span> <span class="nav-text">虚拟机做旁路由</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="nav-number">3.4.</span> <span class="nav-text">软件包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#shadowsocksR-plus"><span class="nav-number">3.4.1.</span> <span class="nav-text">shadowsocksR plus+</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FRP%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F"><span class="nav-number">3.4.2.</span> <span class="nav-text">FRP内网穿透</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="nav-number">3.4.3.</span> <span class="nav-text">负载均衡</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%AE%A4%E8%AF%81"><span class="nav-number">4.</span> <span class="nav-text">校园网认证</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#LED%E7%81%AF%E5%BC%80%E5%85%B3"><span class="nav-number">5.</span> <span class="nav-text">LED灯开关</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="lyz05" src="/images/avatar.webp"><p class="site-author-name" itemprop="name">lyz05</p><div class="site-description" itemprop="description">怯,你就会输一辈子</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">95</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">12</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/lyz05" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lyz05" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a> </span><span class="links-of-author-item"><a href="mailto:blog@lyz05.cn" title="E-Mail → mailto:blog@lyz05.cn" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i></a> </span><span class="links-of-author-item"><a href="http://www.zhihu.com/people/liu-yuan-zhe-16" title="知乎 → http:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;liu-yuan-zhe-16" rel="noopener me" target="_blank"><i class="iconfont icon-douban fa-fw"></i></a> </span><span class="links-of-author-item"><a href="http://www.douban.com/people/140286755/" title="豆瓣 → http:&#x2F;&#x2F;www.douban.com&#x2F;people&#x2F;140286755&#x2F;" rel="noopener me" target="_blank"><i class="iconfont icon-zhihu fa-fw"></i></a></span></div><div class="cc-license animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.lyz05.cn/2019/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.webp"><meta itemprop="name" content="lyz05"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Lyz's Blog"><meta itemprop="description" content="怯,你就会输一辈子"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="PandoraBox使用记录 | Lyz's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">PandoraBox使用记录<a href="https://github.com/lyz05/lyz05.github.io/tree/blog/source/_posts/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95.md" class="post-edit-link" title="编辑" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a></h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-11-17 17:32:06" itemprop="dateCreated datePublished" datetime="2019-11-17T17:32:06+00:00">2019-11-17</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%BA%92%E8%81%94%E7%BD%91/" itemprop="url" rel="index"><span itemprop="name">互联网</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%BA%92%E8%81%94%E7%BD%91/%E5%8E%9F%E5%88%9B/" itemprop="url" rel="index"><span itemprop="name">原创</span></a> </span></span><span id="/2019/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/" class="post-meta-item leancloud_visitors" data-flag-title="PandoraBox使用记录" title="阅读次数"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>9.9k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>9 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>其实早在大一下就开始使用PandoraBox了，奈何一直没有写篇博文记录一下。<br>PandoraBox是国内从原版OpenWrt整出来的分支。最开始时，我是想直接用OpenWrt，但是好像我用的版本在路由器上有些问题。<br>后面发现了PandoraBox，有着除名字不同外，几乎一模一样的OpenWrt。<br>本次使用的路由器是斐讯K2p。早在高中时就有耳闻当时斐讯搞得0元购，奈何自己太年轻，并没有及时上车。所以我上车的时候已经晚了。<br>以为遭阿里系的封杀，我在腾讯系的转转找了一个专门做斐讯硬改和刷机的商家，选了硬改的斐讯k2p，大概270元左右，己经相当贵了，但是挺值的。（主要原因还是知名度太高，被炒高价格了）暑假帮同学再买时又贵了10-20元。</p><h2 id="需求-选择"><a href="#需求-选择" class="headerlink" title="需求&amp;选择"></a>需求&amp;选择</h2><p>有两大需求促使我买一台路由器，并刷机上PandoraBox。<br>一是我需要一个支持WIFI 5(802.11ac)且穿墙信号尚可的路由器，用于家里上网，家里广电原配的渣渣路由器穿墙能力不行。<br>二是学校宿舍需要一台路由器，搞定我在学校使用WIFI上网的难题。因为学校宽带贼贵，我没买，WIFI绑定MAC地址上网。<br>如果只是普通的上网，那也不需要刷机，主要是想实现路由器WIFI自动认证，以及使用附带的其他功能。如：打印机、SSR。<br>打印机是因为宿舍弄了个小型打印店，方便我直接远程打印。<br>SSR不解释</p><h3 id="系统选择"><a href="#系统选择" class="headerlink" title="系统选择"></a>系统选择</h3><p>而在所有的路由器相关的系统中，也就OpenWrt的软件包最为多，可以实现高度定制化的功能。就直接上手最难的OpenWrt。后面，歪打正着的遇到了PandoraBox。</p><h3 id="路由器选择"><a href="#路由器选择" class="headerlink" title="路由器选择"></a>路由器选择</h3><p>主要还是因为我孤陋寡闻，只知道K2P牛逼，支持刷机。因为原版K2P是不带USB口的，然后看到有硬改的，而且直接刷好，完美符合小白的我的需求。</p><h1 id="刷机"><a href="#刷机" class="headerlink" title="刷机"></a>刷机</h1><h2 id="uboot"><a href="#uboot" class="headerlink" title="uboot"></a>uboot</h2><p>首先选择一台成色上好的路由器，然后开始刷机。<br>刷机前，像安卓机的Recovery系统一样，需要刷个预刷机系统不死uboot。<br><a target="_blank" rel="noopener" href="http://www.elecfans.com/dianzichangshi/20171211600608_a.html">不死uboot使用教程 - 全文</a><br>上面有一篇关于uboot的使用教程，和针对newifi的刷机教程。<br>因为买回来的时候已经是刷好uboot的了。所以，并没有实际尝试过，只能云尝试一波。</p><h2 id="Pandorabox"><a href="#Pandorabox" class="headerlink" title="Pandorabox"></a>Pandorabox</h2><p><a target="_blank" rel="noopener" href="https://www.right.com.cn/forum/thread-361922-1-1.html">K2P A1 A2 路由器刷机教程 最详细教程，适合新手！</a><br>然后就是PandoraBox的刷机了，首先肯定是各种备份，把uboot中能备份的组件都备份了。然后选择固件上传，开刷就好。<br>刷机记得选择的是公版。<br>默认用户名密码<code>root</code>和<code>admin</code></p><h2 id="LEDE"><a href="#LEDE" class="headerlink" title="LEDE"></a>LEDE</h2><p><a target="_blank" rel="noopener" href="http://firmware.koolshare.cn/LEDE_X64_fw867/">koolshare Lede X64 Nuc</a><br>在上面这个链接可以下载到适用于Vmware的LEDE镜像<br>默认密码<code>koolshare</code></p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="配置上网"><a href="#配置上网" class="headerlink" title="配置上网"></a>配置上网</h2><h3 id="路由器配置"><a href="#路由器配置" class="headerlink" title="路由器配置"></a>路由器配置</h3><p>刷好之后，应该可以通过路由器ip访问到uhttpd搭载的luci界面。<br>默认的WAN口连接方式是DHCP客户端，如果网线可以直接使用DHCP获取ip地址上网，就不需要配置。<br>我在学校就需要通过WIFI桥接的方式来联网。<br>在网络————无线中选择扫描，选择要连接的WIFI，输入密码。分配WAN防火墙。一路下一步就可以完成。这种方式相当于WIFI接入WAN口，套了一层NAT。但可以所有设备公用这一个IP地址的网络。所以，接下来要解决的就是让路由器像手机一样认证学校WIFI。<br>学校WIFI其实就是一个网页，通过抓包可以看到学校WIFI认证的URL，访问这个URL就可以认证。这样也就绕过了网页中的只允许手机设备认证的限制。<br>除了当路由器用，也可以当交换机用，只需要关闭DHCP服务，所有的设备都接入LAN口就好。</p><h3 id="虚拟机配置"><a href="#虚拟机配置" class="headerlink" title="虚拟机配置"></a>虚拟机配置</h3><p>虚拟机因为有显示器和默认路由器的原因，需要自己配置网络<br><code>vi /etc/config/network</code>中配置静态ip桥接接入宿主主机网络。这个口为LAN口<br>单一LAN口还需要配置网关和DNS</p><h2 id="SSH管理"><a href="#SSH管理" class="headerlink" title="SSH管理"></a>SSH管理</h2><p>在系统——管理中可以设置SSH管理方式，修改密码，添加密钥。</p><h2 id="酷软中心"><a href="#酷软中心" class="headerlink" title="酷软中心"></a>酷软中心</h2><p>这好像是个asp的动态网页，加上虚拟机强大的性能，完美的图像化，傻瓜都可以配置。<br>关键字<code>koolss</code></p><h3 id="虚拟机做旁路由"><a href="#虚拟机做旁路由" class="headerlink" title="虚拟机做旁路由"></a>虚拟机做旁路由</h3><p>这是比较麻烦的事情，因为要做旁路由，简单的说，虚拟机桥接物理网络，配置好虚拟机IP地址，然后需要走旁路由的机子，手动配置网关和DNS。如果拥有局域网中的网关权限，那还可以更自由话的更改DHCP服务器，相关配置。<br>只要做到所有往内网外的报全部转到旁路由，由旁路由转发即可。</p><h2 id="软件包"><a href="#软件包" class="headerlink" title="软件包"></a>软件包</h2><p>OP(OpenWrt)的可玩性在于丰富的软件包，以及类linux的Shell。<br>OP使用opkg包管理器，一个类似于apt的包管理器。可以通过shell或者luci界面安装，安装luci应用可以直接过滤luci的包。自动解决依赖。</p><h3 id="shadowsocksR-plus"><a href="#shadowsocksR-plus" class="headerlink" title="shadowsocksR plus+"></a>shadowsocksR plus+</h3><p>在路由器上直接配置就好了，1904版本支持多节点轮换，当主节点挂了，可以自动切换结点。路由方式等各种功能还是比较全的。</p><h3 id="FRP内网穿透"><a href="#FRP内网穿透" class="headerlink" title="FRP内网穿透"></a>FRP内网穿透</h3><p>frp的路由器版本，也可以直接用作者github上编译的路由器版本，那就没有luci界面可用了。</p><h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>解决多WAN上网的问题。<br>除了可以单个设备认证wifi热点上网，还可以实现多个设备认证WiFi上网。通过k2p的两个无线网卡，可以分别接入学校的wifi，然后做MAC地址伪装，在从不同的网络接口发出认证包，结合负载均衡(mwan3)就可以实现多WAN上网。目前我在用的就是这种形式(10M+5M)<br>mwan3配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">config rule &#x27;login1&#x27;</span><br><span class="line">	option dest_ip &#x27;10.0.0.0/16&#x27;</span><br><span class="line">	option sticky &#x27;0&#x27;</span><br><span class="line">	option proto &#x27;all&#x27;</span><br><span class="line">	option use_policy &#x27;wwan1_only&#x27;</span><br><span class="line">	option src_ip &#x27;192.168.1.100&#x27;</span><br><span class="line"></span><br><span class="line">config rule &#x27;login&#x27;</span><br><span class="line">	option dest_ip &#x27;10.0.0.0/16&#x27;</span><br><span class="line">	option sticky &#x27;0&#x27;</span><br><span class="line">	option proto &#x27;all&#x27;</span><br><span class="line">	option use_policy &#x27;wwan_only&#x27;</span><br><span class="line">	option src_ip &#x27;192.168.1.1&#x27;</span><br><span class="line"></span><br><span class="line">config rule &#x27;vpn&#x27;</span><br><span class="line">	option dest_ip &#x27;10.1.0.0/16&#x27;</span><br><span class="line">	option proto &#x27;all&#x27;</span><br><span class="line">	option sticky &#x27;0&#x27;</span><br><span class="line">	option use_policy &#x27;wwan1_only&#x27;</span><br><span class="line"></span><br><span class="line">config rule &#x27;https&#x27;</span><br><span class="line">	option sticky &#x27;1&#x27;</span><br><span class="line">	option dest_port &#x27;443&#x27;</span><br><span class="line">	option proto &#x27;tcp&#x27;</span><br><span class="line">	option use_policy &#x27;wwan1_only&#x27;</span><br><span class="line"></span><br><span class="line">config rule &#x27;default_rule&#x27;</span><br><span class="line">	option dest_ip &#x27;0.0.0.0/0&#x27;</span><br><span class="line">	option proto &#x27;all&#x27;</span><br><span class="line">	option sticky &#x27;0&#x27;</span><br><span class="line">	option use_policy &#x27;wwan1_only&#x27;</span><br><span class="line"></span><br><span class="line">config policy &#x27;balanced&#x27;</span><br><span class="line">	option last_resort &#x27;default&#x27;</span><br><span class="line">	list use_member &#x27;wwan1_m1_w1&#x27;</span><br><span class="line">	list use_member &#x27;wwan_m1_w1&#x27;</span><br><span class="line"></span><br><span class="line">config interface &#x27;wwan1&#x27;</span><br><span class="line">	option enabled &#x27;1&#x27;</span><br><span class="line">	option family &#x27;ipv4&#x27;</span><br><span class="line">	option count &#x27;1&#x27;</span><br><span class="line">	option size &#x27;56&#x27;</span><br><span class="line">	option timeout &#x27;2&#x27;</span><br><span class="line">	option interval &#x27;5&#x27;</span><br><span class="line">	option failure_interval &#x27;5&#x27;</span><br><span class="line">	option recovery_interval &#x27;5&#x27;</span><br><span class="line">	option flush_conntrack &#x27;never&#x27;</span><br><span class="line">	option reliability &#x27;1&#x27;</span><br><span class="line">	list track_ip &#x27;10.0.10.11&#x27;</span><br><span class="line">	option down &#x27;5&#x27;</span><br><span class="line">	option up &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line">config interface &#x27;wwan&#x27;</span><br><span class="line">	option enabled &#x27;1&#x27;</span><br><span class="line">	option family &#x27;ipv4&#x27;</span><br><span class="line">	option count &#x27;1&#x27;</span><br><span class="line">	option size &#x27;56&#x27;</span><br><span class="line">	option timeout &#x27;2&#x27;</span><br><span class="line">	option interval &#x27;5&#x27;</span><br><span class="line">	option failure_interval &#x27;5&#x27;</span><br><span class="line">	option recovery_interval &#x27;5&#x27;</span><br><span class="line">	option flush_conntrack &#x27;never&#x27;</span><br><span class="line">	option reliability &#x27;1&#x27;</span><br><span class="line">	list track_ip &#x27;10.0.10.11&#x27;</span><br><span class="line">	option down &#x27;5&#x27;</span><br><span class="line">	option up &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line">config member &#x27;wwan1_m1_w1&#x27;</span><br><span class="line">	option interface &#x27;wwan1&#x27;</span><br><span class="line">	option metric &#x27;1&#x27;</span><br><span class="line">	option weight &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line">config member &#x27;wwan_m1_w1&#x27;</span><br><span class="line">	option interface &#x27;wwan&#x27;</span><br><span class="line">	option metric &#x27;1&#x27;</span><br><span class="line">	option weight &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line">config policy &#x27;wwan_only&#x27;</span><br><span class="line">	list use_member &#x27;wwan_m1_w1&#x27;</span><br><span class="line">	option last_resort &#x27;default&#x27;</span><br><span class="line"></span><br><span class="line">config policy &#x27;wwan1_only&#x27;</span><br><span class="line">	list use_member &#x27;wwan1_m1_w1&#x27;</span><br><span class="line">	option last_resort &#x27;default&#x27;</span><br></pre></td></tr></table></figure><h1 id="校园网认证"><a href="#校园网认证" class="headerlink" title="校园网认证"></a>校园网认证</h1><p>这是我写的校园网认证用的shell脚本。<br>这个脚本有指定从那个接口发包，拿去用时，要自己修改一下。<br>auth.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#依赖：curl,wget,network.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#account=180021107080</span></span><br><span class="line">loginurl=<span class="string">&quot;http://10.0.21.23/wifi.jhtml?loginurl&amp;userid=180021104890&amp;ip=10.0.15.102:8080&amp;unicom=1&amp;username=&amp;password=&quot;</span></span><br><span class="line">logouturl=<span class="string">&quot;http://10.0.15.102:8080/portal/entrance/http_logout.jsp?language=Chinese&quot;</span></span><br><span class="line">urlfilename=<span class="string">&quot;/root/0.txt&quot;</span></span><br><span class="line">loginfilename=<span class="string">&quot;/root/login.txt&quot;</span></span><br><span class="line">logoutfilename=<span class="string">&quot;/root/logout.txt&quot;</span></span><br><span class="line">networkfilename=<span class="string">&quot;/root/network.sh&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">login</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">#获取认证链接</span></span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&#x27;获取认证链接过程：&#x27;</span></span><br><span class="line">	/usr/bin/curl --interface apclix0 -m 5 <span class="variable">$loginurl</span> -o <span class="variable">$urlfilename</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">#读取并显示认证链接信息</span></span><br><span class="line">	str=$(<span class="built_in">cat</span> /root/0.txt)</span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&#x27;\n认证原始链接：&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$str</span></span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&#x27;认证处理后链接：&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$&#123;str:21:197&#125;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 5); <span class="keyword">do</span></span><br><span class="line">		<span class="comment">#访问认证链接</span></span><br><span class="line">		<span class="built_in">echo</span> -e <span class="string">&#x27;认证过程：&#x27;</span></span><br><span class="line">		/usr/bin/wget --bind-address=10.3.20.249 --header=<span class="string">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot;</span> --header=<span class="string">&quot;Accept-Encoding: gzip, deflate&quot;</span> --header=<span class="string">&quot;Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8&quot;</span> -U <span class="string">&quot;Mozilla/5.0 (Linux; U; Android 2.2.1; en-us; Nexus One Build/FRG83) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1&quot;</span> -O <span class="variable">$loginfilename</span> <span class="string">&quot;<span class="variable">$&#123;str:21:197&#125;</span>&quot;</span></span><br><span class="line">		<span class="comment">#/usr/bin/curl --interface apcli0 --header &quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot; --header &quot;Accept-Encoding: gzip, deflate&quot; --header &quot;Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8&quot; -A &quot;Mozilla/5.0 (Linux; U; Android 2.2.1; en-us; Nexus One Build/FRG83) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1&quot; -o $loginfilename &quot;$&#123;str:21:193&#125;&quot;</span></span><br><span class="line">		<span class="comment">#获取认证返回信息文件的大小</span></span><br><span class="line">		size=$(<span class="built_in">ls</span> -l <span class="variable">$loginfilename</span> | awk <span class="string">&#x27;&#123;print $5&#125;&#x27;</span>)</span><br><span class="line">		<span class="built_in">echo</span> -e <span class="string">&#x27;认证结果文件大小：&#x27;</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$size</span></span><br><span class="line">		<span class="comment">#显示认证返回信息</span></span><br><span class="line">		str1=$(<span class="built_in">cat</span> <span class="variable">$loginfilename</span>)</span><br><span class="line">		<span class="built_in">echo</span> -e <span class="string">&#x27;认证返回信息：\n&#x27;</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$str1</span></span><br><span class="line">		<span class="comment">#判断认证是否成功</span></span><br><span class="line">		<span class="keyword">if</span> [ <span class="variable">$size</span> = <span class="string">&quot;7&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">			<span class="built_in">break</span>;</span><br><span class="line">		<span class="keyword">fi</span></span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">logout</span></span>()</span><br><span class="line">&#123;	</span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&#x27;下线过程：&#x27;</span></span><br><span class="line">	/usr/bin/curl --interface apclix0 --header <span class="string">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot;</span> --header <span class="string">&quot;Accept-Encoding: gzip, deflate&quot;</span> --header <span class="string">&quot;Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8&quot;</span> -A <span class="string">&quot;Mozilla/5.0 (Linux; U; Android 2.2.1; en-us; Nexus One Build/FRG83) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1&quot;</span> -o <span class="variable">$logoutfilename</span> <span class="variable">$logouturl</span></span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&#x27;下线结果：&#x27;</span></span><br><span class="line">	str=$(<span class="built_in">cat</span> <span class="variable">$logoutfilename</span>)</span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$str</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">relogin</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	ash <span class="variable">$networkfilename</span> www.baidu.com</span><br><span class="line">	<span class="keyword">if</span> [ $? -eq 1 ]; <span class="keyword">then</span></span><br><span class="line">		login</span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">help</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;auth version: auth&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;Describe: 校园网认证工具&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;Useage：auth [command]&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> -e <span class="string">&#x27;\nOptions:&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27; login			: 校园网认证&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27; logout			: 校园网下线&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27; relogin		: 校园网检测断线并重连，与crontab搭配使用&#x27;</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27; help			: 显示本帮助信息&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -d <span class="variable">$1</span> ]; <span class="keyword">then</span> </span><br><span class="line">	<span class="built_in">help</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$1</span> = <span class="string">&quot;help&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">help</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$1</span> = <span class="string">&quot;login&quot;</span> ]; <span class="keyword">then</span> </span><br><span class="line">	login</span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$1</span> = <span class="string">&quot;logout&quot;</span> ]; <span class="keyword">then</span> </span><br><span class="line">	<span class="built_in">logout</span> </span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$1</span> = <span class="string">&quot;relogin&quot;</span> ]; <span class="keyword">then</span> </span><br><span class="line">	relogin </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;无效的参数&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#wget --header=&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot; --header=&quot;Accept-Encoding: gzip, deflate&quot; --header=&quot;Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8&quot; -U &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36&quot; -O 0.txt &#x27;http://blxx.zhbit.com/wifi.jhtml?loginurl&amp;userid=180021104890&amp;ip=10.0.15.102:8080&amp;unicom=0&amp;username=&amp;password=&#x27;</span></span><br><span class="line"><span class="comment">#blxx.zhbit.com</span></span><br><span class="line"><span class="comment">#/usr/bin/wget --bind-address=10.3.44.59 --header=&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot; --header=&quot;Accept-Encoding: gzip, deflate&quot; --header=&quot;Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8&quot; -U &quot;Mozilla/5.0 (Linux; U; Android 2.2.1; en-us; Nexus One Build/FRG83) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1&quot; -O $logoutfilename $logouturl</span></span><br></pre></td></tr></table></figure><p>network.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#检测网络连接</span></span><br><span class="line"><span class="comment">#依赖：httping</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">httptest</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	httping -c 2 -t 1 <span class="variable">$1</span> &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">	<span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> success</span><br><span class="line">		<span class="built_in">return</span> 0</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> failed</span><br><span class="line">		<span class="built_in">return</span> 1</span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">pingtest</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	ping -W 2 -c 2  <span class="variable">$1</span> &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">	<span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> success</span><br><span class="line">		<span class="built_in">return</span> 0</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> failed</span><br><span class="line">		<span class="built_in">return</span> 1</span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> [ -d <span class="variable">$1</span> ]; <span class="keyword">then</span> </span><br><span class="line">	<span class="built_in">echo</span> -n <span class="string">&#x27;校园dns测试.........&#x27;</span></span><br><span class="line">	pingtest 10.0.10.11</span><br><span class="line">	<span class="built_in">echo</span> -n <span class="string">&#x27;校园官网测试.........&#x27;</span></span><br><span class="line">	httptest www.bitzh.edu.cn</span><br><span class="line">	<span class="built_in">echo</span> -n <span class="string">&#x27;Baidu测试.........&#x27;</span></span><br><span class="line">	pingtest www.baidu.com</span><br><span class="line">	<span class="built_in">echo</span> -n <span class="string">&#x27;google测试.........&#x27;</span></span><br><span class="line">	httptest www.google.com</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> -n <span class="variable">$1</span><span class="string">&#x27; test......&#x27;</span></span><br><span class="line">	pingtest <span class="variable">$1</span></span><br><span class="line">	<span class="comment">#echo $?</span></span><br><span class="line">	<span class="built_in">exit</span> $?</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>与corntab结合可以实现定时自动认证，corntab+auth.sh relogin可以实现轮询检测是否断网，从而重新认证。<br>对于我来说一般不会掉认证。但是因为学校的WIFI晚上1点会有使用时段限制，所以每天一大早就会掉认证，这就需要每天一大早，给他自动认证一发。<br>corntab中使用的执行语句</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/root/auth.sh relogin &gt; /root/auth.log 2&gt;&amp;1  &amp;</span><br></pre></td></tr></table></figure><p>修改rc.local可以添加路由器启动时执行的语句<br>因为rc.local执行的时候网络还没初始化好，所以要延迟执行语句,我设置的是1min，相对来说比较合适。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sleep</span> 60 &amp;&amp; /root/auth.sh relogin &gt; /root/auth.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><h1 id="LED灯开关"><a href="#LED灯开关" class="headerlink" title="LED灯开关"></a>LED灯开关</h1><p>鉴于晚上LED灯刺眼，所以使用脚本开关<br>关灯脚本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">ls</span> /sys/class/leds`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">cd</span> /sys/class/leds</span><br><span class="line">  <span class="built_in">cd</span> <span class="variable">$i</span></span><br><span class="line">  <span class="built_in">echo</span> 0 &gt; brightness</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>开灯脚本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/led start</span><br></pre></td></tr></table></figure><p>然后弄一个crontab就好了</p></div><footer class="post-footer"><div class="reward-container"><div>请我一杯咖啡吧！</div><button>赞赏</button><div class="post-reward"><div><img src="/images/wechatpay.png" alt="lyz05 微信"> <span>微信</span></div><div><img src="/images/alipay.jpg" alt="lyz05 支付宝"> <span>支付宝</span></div></div></div><div class="post-tags"><a href="/tags/%E6%95%99%E7%A8%8B/" rel="tag"><i class="fa fa-tag"></i> 教程</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"><i class="fa fa-tag"></i> 网络</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2019/%E4%BB%8EGit%E4%BB%93%E5%BA%93%E4%B8%AD%E5%88%A0%E9%99%A4%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE/" rel="prev" title="从Git仓库中删除敏感数据"><i class="fa fa-angle-left"></i> 从Git仓库中删除敏感数据</a></div><div class="post-nav-item"><a href="/2019/Windows%E6%9C%8D%E5%8A%A1%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/" rel="next" title="Windows服务使用记录">Windows服务使用记录 <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2015 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">lyz05</span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div><div class="footer-custom">Website source code <a target="_blank" rel="noopener" href="//github.com/lyz05/hexo">here</a></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><a href="https://github.com/lyz05" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script class="next-config" data-name="valine" type="application/json">{"enable":true,"appId":"IOO0v6UWzOQE94hPLrgXiQhg-9Nh9j0Va","appKey":"vBfyrsgGJnqg8qG3PD4MglR8","serverURLs":"https://ioo0v6uw.lc-cn-n1-shared.com","placeholder":"Just go go","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":null,"visitor":true,"comment_count":true,"recordIP":true,"enableQQ":false,"requiredFields":[],"libUrl":"https://cdnjs.cloudflare.com/ajax/libs/valine/1.5.3/Valine.min.js","el":"#valine-comments","path":"/2019/PandoraBox%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"}</script><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.valine.el)
    .then(() => NexT.utils.getScript(
      CONFIG.valine.libUrl,
      { condition: window.Valine }
    ))
    .then(() => {
      new Valine(CONFIG.valine);
    });
});</script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>